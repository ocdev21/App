FROM registry.access.redhat.com/ubi8/python-39:latest

USER root

RUN yum install -y gcc gcc-c++ python3-devel && yum clean all

RUN pip install --no-cache-dir ctransformers flask requests

COPY mistral-7b-instruct-v0.2.Q4_K_M.gguf /models/mistral.gguf

RUN chmod -R 755 /models

COPY gguf-inference-server.py /app/gguf-server.py

RUN chmod +x /app/gguf-server.py

USER 1001

EXPOSE 8000

ENV PYTHONUNBUFFERED=1

CMD ["python3", "/app/gguf-server.py"]
