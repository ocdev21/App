# Using Red Hat UBI (Universal Base Image) - Best for OpenShift
# This image is from Red Hat's registry and works well in enterprise environments
FROM registry.access.redhat.com/ubi9/python-311:latest

# Alternative registries if needed:
# FROM quay.io/centos/python-311-centos9:latest
# FROM mcr.microsoft.com/devcontainers/python:3.11

WORKDIR /app

# Install kubectl as standalone binary (works with any base image)
# Switch to root user to install kubectl, then switch back
USER 0
RUN curl -LO https://dl.k8s.io/release/v1.28.0/bin/linux/amd64/kubectl \
    && chmod +x kubectl \
    && mv kubectl /usr/local/bin/kubectl \
    && kubectl version --client || true

COPY requirements.txt .

RUN pip install --no-cache-dir -r requirements.txt

COPY crew_code37.py .

RUN chmod +x crew_code37.py

ENV PYTHONUNBUFFERED=1

CMD ["python", "crew_code37.py"]
